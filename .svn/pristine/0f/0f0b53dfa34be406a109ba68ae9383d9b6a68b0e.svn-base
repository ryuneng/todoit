<%@page import="vo.CommReplyLike"%>
<%@page import="utils.StringUtils"%>
<%@page import="vo.User"%>
<%@page import="vo.CommLike"%>
<%@page import="dao.CommLikeDao"%>
<%@page import="vo.CommReply"%>
<%@page import="java.util.List"%>
<%@page import="dao.CommReplyDao"%>
<%@page import="dto.LoginUser"%>
<%@page import="utils.DateUtils"%>
<%@page import="vo.Community"%>
<%@page import="dao.CommunityDao"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<script src="https://kit.fontawesome.com/bdbabb79d8.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
<style>
@font-face {
    font-family: 'SUIT-Regular';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_suit@1.0/SUIT-Regular.woff2') format('woff2');
    font-weight: normal;
    font-style: normal;
}
body {
	font-family: 'SUIT-Regular';
}
</style>
<title>TODOIT::ì»¤ë®¤ë‹ˆí‹° ìƒì„¸</title>
</head>
<body>
<jsp:include page="../include/navbar.jsp">
	<jsp:param value="community" name="manu"/>
</jsp:include>

<div class="container">
	<div class="row">
		<div class="col-12">
<%
	LoginUser loginUser = (LoginUser) session.getAttribute("LOGIN_USER");

	int no = Integer.parseInt(request.getParameter("no"));
	int pageNo = Integer.parseInt(request.getParameter("page"));
	String error = request.getParameter("error");
	String success = request.getParameter("success");

	if("dangerFail".equals(error)) {
%>
	<script type="text/javascript">
		alert('ì´ë¯¸ ì‹ ê³ í•œ ëŒ“ê¸€ì€ ì‹ ê³ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
	</script>
<%
	}
	if("dangerSuccess".equals(success)) {
%>
	<script type="text/javascript">
		alert('ëŒ“ê¸€ì´ ì‹ ê³ ë˜ì—ˆìŠµë‹ˆë‹¤.');
	</script>
<%
	}
	if("likeSuccess".equals(success)) {
%>
	<script type="text/javascript">
		alert('ì¢‹ì•„í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!');
	</script>
<%
	}
	if("deleteLike".equals(success)) {
%>
	<script type="text/javascript">
		alert('ì¢‹ì•„ìš”ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');
	</script>
<%
	}
	if("likeFail".equals(error)) {
%>
	<script type="text/javascript">
		alert('ì´ë¯¸ ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥´ì‹  ëŒ“ê¸€ì…ë‹ˆë‹¤.');
	</script>
<%
	}
	
	CommunityDao commDao = new CommunityDao();
	Community community = commDao.getCommunityByNo(no);

	community.setViewCnt(community.getViewCnt() + 1);
	commDao.updateCommunity(community);
%>
<%
	if (loginUser != null && loginUser.getNo() == community.getUser().getNo()) {
%>
			<div class="d-flex justify-content-end mb-3">
				<a href="modifyform.jsp?no=<%=no %>&page=<%=pageNo %>" class="btn btn-warning me-1">ìˆ˜ì •</a>
				<a href="delete.jsp?no=<%=no %>&page=<%=pageNo %>" class="btn btn-danger">ì‚­ì œ</a>
			</div>
<%
	} 
%>
			<h4 class="mt-3 mb-3"><%=community.getTitle() %></h4>
		</div>
		<hr>
	</div>
	
	<!-- ì‘ì„±ì ì •ë³´ - í”„ë¡œí•„ ì‚¬ì§„, ì‘ì„±ì¼, ì¡°íšŒìˆ˜ -->	
	<div class="row">
		<div class="col-12">
			<div class="d-flex justify-content-start mb-3">
				<a href="/user/profile.jsp?userNo=<%=community.getUser().getNo() %>">
					<img src="../resources/images/user/<%=community.getUser().getFilename() %>" class="rounded-circle" width="50" height="50">
				</a>
				<div class="ms-3">
					<span><%=community.getUser().getNickname() %></span>
					<div class="d-flex justify-content-between">
	    				<span><%=DateUtils.toText(community.getCreatedDate()) %></span>
			    		<span class="ms-3">ì¡°íšŒìˆ˜ <%=community.getViewCnt() %></span>
	  				</div>
	  			</div>
			</div>
		</div>
		<hr>
	</div>
	
	<div class="row mt-3 mb-3">
		<div class="col-12">
			<div class="card">
    			<a href="../meeting/detail.jsp?meetNo=<%=community.getMeeting().getNo() %>" class="link-offset-2 link-underline link-underline-opacity-0">
	  			<div class="card-body text-black">
 			
    				<h6 class="card-title fw-bold"><%=community.getMeeting().getTitle() %></h6>
    				<p class="card-text text-secondary text-start mb-0" style="font-size: 13px;">
    				<%=community.getMeeting().getAddress() %></p>
    				
	  			</div>
    			</a>
	  		</div>
		</div>
  	</div>
  	
  	<div class="row mt-3 mb-3">
  		<div class="col-12">
<%
	if (community.getCategory().getNo() == 100001) {
%>
  			<span>í‰ì  :	</span>
<%
		for (int i = 1; i <= community.getScore(); i++) { 
%>
	  			<i class="fa-solid fa-star"></i>
<%
		}
	} 
%>
  	</div>
  	
  	<div class="row mt-3">
  		<div class="col-3">
  			<img src="../resources/images/community/<%=community.getImageName() %>" class="img-thumbnail" style="width:100%;">  			
  		</div>  		
  		<div class="col-9">
			<div class="p-3 mb-3">
				<p><%=StringUtils.withBr(community.getContent()) %></p>
			</div>
  		</div>
  		</div>
  	</div>
	
  	<div class="row mt-5 mb-3">  	
  	 	<div class="col-12">
  	 		<div class="text-center">
<%
	if (loginUser == null) {
%>
				<button type="button" class="btn btn-outline-danger" onclick="loginAlert()">
					ì¢‹ì•„ìš” <span class="badge text-bg-danger"><%=community.getLikeCnt() %></span>
				</button>
<%
	} else {
		User user = new User();
		user.setNo(loginUser.getNo());
		
		CommLike commLike = new CommLike();
		commLike.setCommunity(community);
		commLike.setUser(user);
		
		CommLikeDao likeDao = new CommLikeDao();
		CommLike savedLike = likeDao.getLike(commLike);
		
		if (savedLike != null) {
		
%>
				<a href="insertLike.jsp?no=<%=no %>&page=<%=pageNo %>" class="btn btn-danger">
					ì¢‹ì•„ìš” <span class="badge text-bg-danger"><%=community.getLikeCnt() %></span>
				</a>
<%
		} else {
%>
				<a href="insertLike.jsp?no=<%=no %>&page=<%=pageNo %>" class="btn btn-outline-danger">
					ì¢‹ì•„ìš” <span class="badge text-bg-danger"><%=community.getLikeCnt() %></span>
				</a>
<%	
		}
	}
%>
				<button type="button" class="btn btn-outline-success" onclick="clip(); return false;">
					ê³µìœ  <i class="fa-solid fa-share"></i></button>
				<button class="btn btn-warning" id="kakao-link-btn">
					<img src="https://developers.kakao.com/assets/img/about/logos/kakaotalksharing/kakaotalk_sharing_btn_medium.png"
    				alt="ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ë³´ë‚´ê¸° ë²„íŠ¼" height="25px" width="25px"/>
    			</button>
			</div>
		</div>
	</div>
  	<hr>
  	
	<div class="row">
		<div class="col-12">
		<h5>ëŒ“ê¸€</h5>
		<form class="border bg-light p-3 mb-3" method="post" action="insertCommReply.jsp" onsubmit="checkContent(event)">
			<input type="hidden" name="no" value="<%=no %>">
			<input type="hidden" name="page" value="<%=pageNo %>">
				<div class="row mb-3">
					<div class="col-sm-11">
						<textarea rows="2" class="form-control" name="content" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
					</div>
					<div class="col-sm-1">
<%
	if (loginUser == null) {
%>
						<button type="button" class="btn btn-outline-primary" onclick="loginAlert()">ë“±ë¡</button>
<%
	} else {
%>
						<button type="submit" class="btn btn-outline-primary">ë“±ë¡</button>
<%
	}
%>
  					</div>
				</div>
		</form>
		
<%
	CommReplyDao replyDao = new CommReplyDao();
	List<CommReply> commReplyList = replyDao.getRepliesByCommunityNo(no);
	
	for (CommReply commReply : commReplyList) {
		
		boolean showDelBtn = false;
		boolean showModifyBtn = false;
		boolean showNoticeBtn = false;
		boolean showReReplyBtn = false;
		
		if (loginUser == null) {
			
		}
		// ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ê´€ë¦¬ìì¸ ê²½ìš° - ì‚­ì œ
		else if (loginUser.getNo() == 100001) {
			showDelBtn = true;
		}
		// ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ëŒ“ê¸€ ì‘ì„±ìì´ë©´ì„œ ê¸€ ì‘ì„±ìì¸ ê²½ìš°
		else if (loginUser.getNo() == commReply.getUser().getNo() && loginUser.getNo() == community.getUser().getNo()) {
			showDelBtn = true;
			showModifyBtn = true;
			showReReplyBtn = true;
		}
		// ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ëŒ“ê¸€ ì‘ì„±ìì¸ ê²½ìš° - ì‚­ì œ, ìˆ˜ì •, ëŒ€ëŒ“ê¸€
		else if (loginUser.getNo() == commReply.getUser().getNo()) {
			showDelBtn = true;
			showModifyBtn = true;
			showReReplyBtn = true;
		}
		// ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ê¸€ ì‘ì„±ìì¸ ê²½ìš° - ì‚­ì œ, ëŒ€ëŒ“ê¸€
		else if (loginUser.getNo() == community.getUser().getNo()) {
			showDelBtn = true;
			showReReplyBtn = true;
		}
		// ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ëŒ“ê¸€ ì‘ì„±ìê°€ ì•„ë‹ˆê³  ê¸€ ì‘ì„±ìê°€ ì•„ë‹Œ ê²½ìš° - ì‹ ê³ , ëŒ€ëŒ“ê¸€
		else if (loginUser.getNo() != commReply.getUser().getNo() || loginUser.getNo() != community.getUser().getNo()) {
			showNoticeBtn = true;
			showReReplyBtn = true;
		}
%>
		<div class="card mb-3">
			<div class="card-header">
				<!-- ëŒ“ê¸€ ì‘ì„±ì ì •ë³´ -->
				<span style="font-weight:bold"><%=commReply.getUser().getNickname() %></span>
				<small><%=DateUtils.toText(commReply.getCreatedDate()) %></small>
<%
	if (showDelBtn) {
%>
				<!-- ëŒ“ê¸€ ì‚­ì œ ë²„íŠ¼ -->
				<a href="deleteReply.jsp?no=<%=no %>&page=<%=pageNo %>&replyNo=<%=commReply.getNo() %>" class="btn btn-danger btn-sm float-end">
				<i class="bi bi-trash"></i></a>
<%
	}

	if (showModifyBtn) {
%>
				<!-- ëŒ“ê¸€ ìˆ˜ì •ë²„íŠ¼ -->
				<button type="button" onclick="toggleReplyUpdateForm(<%=commReply.getNo() %>)"
						class="btn btn-warning btn-sm float-end"><i class="bi bi-eraser"></i></button>
<%
	}

	if (showNoticeBtn) {
%>
				<!-- ëŒ“ê¸€ ì‹ ê³  ë²„íŠ¼ -->
				<a href="insertReplyDangerCnt.jsp?no=<%=community.getNo() %>&page=<%=pageNo %>&replyNo=<%=commReply.getNo() %>"
					class="btn btn-outline-danger btn-sm float-end">ğŸš¨</a>
<%
	}

	if (showReReplyBtn) {
%>
				<!-- ëŒ€ëŒ“ê¸€ ì‘ì„± ë²„íŠ¼ -->
				<button type="button" onclick="toggleReplyinsertForm(<%=commReply.getNo() %>)"
						class="btn btn-secondary btn-sm float-end"><i class="bi bi-arrow-return-right"></i></button>
<%
	}
%>
			</div>
<%
	if (commReply.getDangerCnt() >= 5) {
%>
			<div class="card-body">
				<!-- ëŒ“ê¸€ ë‚´ìš© -->
				<p class="card-text">ì‹ ê³ ëœ ëŒ“ê¸€ì…ë‹ˆë‹¤.</p>
<%
	} else {
%>
			<div class="card-body">
				<!-- ëŒ“ê¸€ ë‚´ìš© -->
				<p class="card-text"><%=StringUtils.withBr(commReply.getContent()) %></p>
<%
		if (loginUser == null) {
%>
				<button class="btn btn-sm" type="button" onclick="loginAlert()" style="text-decoration:none;color:red;padding:0;">
               		<i class="fa-regular fa-heart"></i>
               </button>
				<span><%=replyDao.getReplyLikeCnt(commReply.getNo()) %></span>
<%
		} else {
			User user = new User();
			user.setNo(loginUser.getNo());
			
			CommReplyLike replyLike = new CommReplyLike();
			replyLike.setUser(user);
			replyLike.setCommReply(commReply);
			
			CommReplyLike savedReplyLike = replyDao.getReplyLike(replyLike);
			if (savedReplyLike != null) {
%>
				<a href="insertReplyLike.jsp?no=<%=community.getNo() %>&page=<%=pageNo %>&replyNo=<%=commReply.getNo() %>" style="text-decoration:none;color:red;">
					<i class="fa-solid fa-heart"></i></a>
					<span><%=replyDao.getReplyLikeCnt(commReply.getNo()) %></span>
<%
			} else {
%>
				<a href="insertReplyLike.jsp?no=<%=community.getNo() %>&page=<%=pageNo %>&replyNo=<%=commReply.getNo() %>" style="text-decoration:none;color:red;">
					<i class="fa-regular fa-heart"></i></a>
					<span><%=replyDao.getReplyLikeCnt(commReply.getNo()) %></span>
<%
			}
		}
%>
<%
	} 
%>
				<!-- ëŒ“ê¸€ ìˆ˜ì • í¼ -->
				<form class="border bg-light p-3 mb-3 d-none"
					id="form-update-reply-<%=commReply.getNo() %>"
					method="post"
					action="modifyCommReply.jsp">
					<input type="hidden" name="no" value="<%=community.getNo() %>">
					<input type="hidden" name="page" value="<%=pageNo %>">
					<input type="hidden" name="replyNo" value="<%=commReply.getNo() %>">
					
					<div class="row mb-3">
						<div class="col-sm-11">
							<textarea rows="2" class="form-control" name="content"><%=StringUtils.withBr(commReply.getContent()) %></textarea>
						</div>
						<div class="col-sm-1 ">
							<button type="submit" class="btn btn-outline-primary" >ìˆ˜ì •</button>
						</div>
					</div>	
				</form>
<%
		List<CommReply> commReReplyList = replyDao.getReReplies(commReply.getNo());
		
		for (CommReply commReReply : commReReplyList) {
			
			boolean showDelBtnRe = false;
			boolean showModifyBtnRe = false;
			boolean showNoticeBtnRe = false;
			
			if (loginUser == null) {
				
			}
			// ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ê´€ë¦¬ìì¸ ê²½ìš° - ì‚­ì œ
			else if (loginUser.getNo() == 100001) {
				showDelBtnRe = true;
			}
			// ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ëŒ“ê¸€ ì‘ì„±ìì´ë©´ì„œ ê¸€ ì‘ì„±ìì¸ ê²½ìš°
			else if (loginUser.getNo() == commReply.getUser().getNo() && loginUser.getNo() == community.getUser().getNo()) {
				showDelBtnRe = true;
				showModifyBtnRe = true;
			}
			// ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ê¸€ ì‘ì„±ìì¸ ê²½ìš° - ì‚­ì œ
			else if (loginUser.getNo() == community.getUser().getNo()) {
				showDelBtnRe = true;
			}
			// ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ëŒ“ê¸€ ì‘ì„±ìì¸ ê²½ìš° - ì‚­ì œ, ìˆ˜ì •
			else if (loginUser.getNo() == commReReply.getUser().getNo()) {
				showDelBtnRe = true;
				showModifyBtnRe = true;
			}
			// ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ëŒ“ê¸€ ì‘ì„±ìê°€ ì•„ë‹Œ ê²½ìš° - ì‹ ê³ 
			else if (loginUser.getNo() != commReReply.getUser().getNo() || loginUser.getNo() != community.getUser().getNo()) {
				showNoticeBtnRe = true;
			}
%>
				<div class="card mb-3 mt-3">
					<div class="card-header">
						<!-- ëŒ€ëŒ“ê¸€ ì‘ì„±ì ì •ë³´ -->
						<span style="font-weight:bold"><%=commReReply.getUser().getNickname() %></span>
						<small><%=DateUtils.toText(commReReply.getCreatedDate()) %></small>
<%
	if (showDelBtnRe) {
%>						
						<!-- ëŒ€ëŒ“ê¸€ ì‚­ì œ ë²„íŠ¼ -->
						<a href="deleteReReply.jsp?no=<%=no %>&page=<%=pageNo %>reReplyNo=<%=commReReply.getNo() %>" class="btn btn-danger btn-sm float-end">
							<i class="bi bi-trash"></i></a>
<%
	}

	if (showModifyBtnRe) {
%>
						<!-- ëŒ€ëŒ“ê¸€ ìˆ˜ì • ë²„íŠ¼ -->
						<button type="button" onclick="toggleReplyUpdateForm(<%=commReReply.getNo() %>)"
						class="btn btn-warning btn-sm float-end "><i class="bi bi-eraser"></i></button>
<%
	}

	if (showNoticeBtnRe) {
%>
				<!-- ëŒ“ê¸€ ì‹ ê³  ë²„íŠ¼ -->
				<a href="insertReplyDangerCnt.jsp?no=<%=community.getNo() %>&page=<%=pageNo %>&replyNo=<%=commReReply.getNo() %>"
					class="btn btn-outline-danger btn-sm float-end ">ğŸš¨</a>
<%
	}
%>
					</div>
<%
	if (commReReply.getDangerCnt() >= 5) {
%>
					<div class="card-body">
						<!-- ëŒ€ëŒ“ê¸€ ë‚´ìš© -->
						<p class="card-text">ì‹ ê³ ëœ ëŒ“ê¸€ì…ë‹ˆë‹¤.</p>
<%
	} else {
%>
					<div class="card-body">
						<!-- ëŒ€ëŒ“ê¸€ ë‚´ìš© -->
						<p class="card-text"><%=StringUtils.withBr(commReReply.getContent()) %></p>
<%
		if (loginUser == null) {
%>
				<button class="btn btn-sm" type="button" onclick="loginAlert()" style="text-decoration:none;color:red;padding:0;">
               		<i class="fa-regular fa-heart"></i>
               </button>
				<span><%=replyDao.getReplyLikeCnt(commReReply.getNo()) %></span>
<%
		} else {
			User user = new User();
			user.setNo(loginUser.getNo());
			
			CommReplyLike replyLike = new CommReplyLike();
			replyLike.setUser(user);
			replyLike.setCommReply(commReReply);
			
			CommReplyLike savedReplyLike = replyDao.getReplyLike(replyLike);
			if (savedReplyLike != null) {
%>
				<a href="insertReplyLike.jsp?no=<%=community.getNo() %>&page=<%=pageNo %>&replyNo=<%=commReReply.getNo() %>" style="text-decoration:none;color:red;">
					<i class="fa-solid fa-heart"></i></a>
					<span><%=replyDao.getReplyLikeCnt(commReReply.getNo()) %></span>
<%
			} else {
%>
				<a href="insertReplyLike.jsp?no=<%=community.getNo() %>&page=<%=pageNo %>&replyNo=<%=commReReply.getNo() %>" style="text-decoration:none;color:red;">
					<i class="fa-regular fa-heart"></i></a>
					<span><%=replyDao.getReplyLikeCnt(commReReply.getNo()) %></span>
<%
			}
		}
	}
%>
						<!-- ëŒ“ê¸€ ìˆ˜ì • í¼ -->
						<form class="border bg-light p-3 mb-3 d-none"
							id="form-update-reply-<%=commReReply.getNo() %>"
							method="post"
							action="modifyCommReReply.jsp">
							<input type="hidden" name="no" value="<%=community.getNo() %>">
							<input type="hidden" name="page" value="<%=pageNo %>">
							<input type="hidden" name="reReplyNo" value="<%=commReReply.getNo() %>">
							
							<div class="row mb-3">
								<div class="col-sm-11">
									<textarea rows="2" class="form-control" name="content"><%=StringUtils.withBr(commReReply.getContent()) %></textarea>
								</div>
								<div class="col-sm-1 ">
									<button type="submit" class="btn btn-outline-primary" >ìˆ˜ì •</button>
								</div>
							</div>	
						</form>
					</div>
                 </div>
<%
		}
%>
				<!-- ëŒ€ëŒ“ê¸€ ì‘ì„± í¼ -->
            	<form class="border bg-light p-3 mt-3 mb-3 d-none" method="post" action="insertCommReReply.jsp" 
            		id="form-insert-reply-<%=commReply.getNo() %>" onsubmit="checkContent(event)">
					<input type="hidden" name="no" value="<%=no %>">
					<input type="hidden" name="page" value="<%=pageNo %>">
					<input type="hidden" name="replyNo" value="<%=commReply.getNo()%>">
					<div class="row mb-3">
						<div class="col-sm-11">
							<textarea rows="1" class="form-control" name="content" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
						</div>
						<div class="col-sm-1">
							<button type="submit" class="btn btn-outline-primary" >ë“±ë¡</button>
  						</div>
					</div>
				</form>
                 
			</div>
		</div>
<%
	}
%>
		</div>
		</div> <!-- ì¹´ë“œ ë‹«í˜ -->
	
	<div class="row mb-3">
		<div class="col-12">
			<div class="text-end">
				<a href="list.jsp?page=<%=pageNo %>" class="btn btn-secondary">ëª©ë¡</a>
			</div>
		</div>
	</div>
	
	<div class="row mb-3">
		<div class="col-12">
			<h5>ë‹¤ë¥¸ ì»¤ë®¤ë‹ˆí‹°ê¸€ ì¶”ì²œ</h5>
		</div>
		<div class="col-12 d-flex justify-content-between">
<%
	List<Community> communityList = commDao.getRecommendCommunities("like", 1, 4);
	for (Community Recommendcomm : communityList) {
%>
			<div class="card-header col-3 mb-3 p-1" style="width: 24%;">
				<a href="detail.jsp?no=<%=Recommendcomm.getNo() %>&page=<%=pageNo %>" class="link-offset-2 link-underline link-underline-opacity-0">
					<img src="../resources/images/community/<%=Recommendcomm.getImageName() %>" class="card-img-top" style="height: 60%" alt="ì»¤ë®¤ë‹ˆí‹°ëŒ€í‘œì‚¬ì§„">
					<div class="card-body p-2">
						<h7 class="card-title text-black"><%=Recommendcomm.getTitle() %></h7>
	    				<p class="card-text"><small class="text-muted"><%=DateUtils.toText(Recommendcomm.getCreatedDate()) %></small></p>
					</div>
				</a>
			</div>
<%
	}
%>
		</div>
	</div> <!-- col ë‹«í˜ -->
	</div> <!-- row ë‹«í˜ -->
	</div>
</div>
</body>
<script type="text/javascript">
	function toggleReplyUpdateForm(replyNo) {
		let element = document.getElementById("form-update-reply-" + replyNo);
		// toggle("í´ë˜ìŠ¤ê°’")
		// ì§€ì •ëœ í´ë˜ìŠ¤ê°’ì„ í† ê¸€ì‹œí‚¨ë‹¤.
		// ì§€ì •ëœ í´ë˜ìŠ¤ê°’ì„ ê°€ì§€ê³  ìˆìœ¼ë©´ ì‚­ì œí•œë‹¤.
		// ì§€ì •ëœ í´ë˜ìŠ¤ê°’ì„ ê°€ì§€ê³  ìˆì§€ ì•Šìœ¼ë©´ ì¶”ê°€í•œë‹¤.
		element.classList.toggle('d-none');
	}
	
	function toggleReplyinsertForm(replyNo) {
		let element = document.getElementById("form-insert-reply-" + replyNo);
		// toggle("í´ë˜ìŠ¤ê°’")
		// ì§€ì •ëœ í´ë˜ìŠ¤ê°’ì„ í† ê¸€ì‹œí‚¨ë‹¤.
		// ì§€ì •ëœ í´ë˜ìŠ¤ê°’ì„ ê°€ì§€ê³  ìˆìœ¼ë©´ ì‚­ì œí•œë‹¤.
		// ì§€ì •ëœ í´ë˜ìŠ¤ê°’ì„ ê°€ì§€ê³  ìˆì§€ ì•Šìœ¼ë©´ ì¶”ê°€í•œë‹¤.
		element.classList.toggle('d-none');
	}
	
	function clip() {
		    var url = '';    // <a>íƒœê·¸ì—ì„œ í˜¸ì¶œí•œ í•¨ìˆ˜ì¸ clip ìƒì„±
		    var textarea = document.createElement("textarea");  
		    //url ë³€ìˆ˜ ìƒì„± í›„, textareaë¼ëŠ” ë³€ìˆ˜ì— textareaì˜ ìš”ì†Œë¥¼ ìƒì„±
		    
		    document.body.appendChild(textarea); //</body> ë°”ë¡œ ìœ„ì— textareaë¥¼ ì¶”ê°€(ì„ì‹œ ê³µê°„ì´ë¼ ìœ„ì¹˜ëŠ” ìƒê´€ ì—†ìŒ)
		    url = window.document.location.href;  //urlì—ëŠ” í˜„ì¬ ì£¼ì†Œê°’ì„ ë„£ì–´ì¤Œ
		    textarea.value = url;  // textarea ê°’ì— urlë¥¼ ë„£ì–´ì¤Œ
		    textarea.select();  //textareaë¥¼ ì„¤ì •
		    document.execCommand("copy");   // ë³µì‚¬
		    document.body.removeChild(textarea); //extarea ìš”ì†Œë¥¼ ì—†ì• ì¤Œ
		    
		    alert("URLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.")  // ì•Œë¦¼ì°½
	}
	 
	function loginAlert() {
	     alert('ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.');
	}
	
	function checkContent() {
		let form = event.target;
		let content = form.querySelector("textarea").value;
		if (content === "") {
			event.preventDefault();
			alert("ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”");
			return;
		}
	}
	
	Kakao.init('9255796b13d48451ac7ccab3bb053c11');
	
	Kakao.Link.createDefaultButton({
	    container: '#kakao-link-btn',
	    objectType: 'feed', // í”¼ë“œ, ë¦¬ìŠ¤íŠ¸ ë“± í…œí”Œë¦¿ ì¢…ë¥˜
	    content: {
	      title: '<%=StringUtils.escape(community.getTitle()) %>',
	      description: '<%=StringUtils.escape(community.getContent()) %>',
	      imageUrl: 'https://img.freepik.com/premium-vector/group-of-teenagers-high-school-students-hug-and-laugh-enjoy-being-friends-with-peers-and-classmates-team-of-happy-teenagers-looking-at-screen-for-advertising-educational-services_140689-7171.jpg?size=626&ext=jpg&ga=GA1.2.1317071095.1706659522&semt=sph',
	      link: {
	    	  mobileWebUrl: 'http://localhost/community/detail.jsp?no=<%=no %>&page=<%=pageNo %>',
	          webUrl : 'http://localhost/community/detail.jsp?no=<%=no %>&page=<%=pageNo %>'
	      },
	    },
	    social: {
	        likeCount: <%=community.getLikeCnt() %>,
	        viewCount: <%=community.getViewCnt() %>,
	      },
	    buttons: [
	      {
	        title: 'ì›¹ìœ¼ë¡œ ì´ë™',
	        link: {
	          mobileWebUrl: 'http://localhost/community/detail.jsp?no=<%=no %>&page=<%=pageNo %>',
	          webUrl : 'http://localhost/community/detail.jsp?no=<%=no %>&page=<%=pageNo %>'
	        },
	      },
	    ],
	  })
	 
</script>
</html>